# 个人报告_16340060_冯扬

## **主要工作**
- 光照
- 摄像机
- 模型导入

### **1.光照**
光照模型由环境、漫反射以及镜面光照组成。

- 环境光照会改变光照的强度，实现物体的明暗效果
- 漫反射以及镜面光照则改变物体受光照的影响
- 漫反射分量越大，物体对着光源的那部分就会越亮
- 镜面光照分量越大则物体反光能力越强


        void main() {
            vec3 color = texture(ourTexture, TexCoord).rgb;
            vec3 norm = normalize(Normal);
            //环境光
            vec3 ambient = ambientStrength * color;
            //漫反射
            vec3 lightDir = normalize(lightPos - FragPos);
            float diff = max(dot(norm, lightDir), 0.0);
            vec3 diffuse = diffuseStrength * diff * lightColor;

            //镜面光
            vec3 viewDir = normalize(viewPos - FragPos);
            vec3 reflectDir = reflect(-lightDir, norm);  
            vec3 halfwayDir = normalize(lightDir + viewDir);  
            float spec = pow(max(dot(norm, halfwayDir), 0.0), ShininessStrength);
            vec3 specular = specularStrength * spec * lightColor;  

            float shadow = ShadowCalculation(FragPosLightSpace);  
            vec3 lighting = (ambient + (1.0 - shadow) * (diffuse + specular)) * color;    

            FragColor = vec4(lighting, 1.0);
        };



### **2.摄像机**
封装了一个 Camera 类, 支持视角移动以及缩放

    // 位置
    glm::vec3 Position = glm::vec3(0.0f, 2.0f, 0.0f);
    // 前向量
    glm::vec3 Front = glm::vec3(1.0f, 0.0f, 0.0f);
    // 上向量
    glm::vec3 Up = glm::vec3(0.0f, 1.0f, 0.0f);
    // 右向量
    glm::vec3 Right;
    // 坐标
    glm::vec3 WorldUp = glm::vec3(0.0f, 0.0f, 0.0f);

### **3.模型导入**
这里使用Assimp作为我们的模型导入库. 主要是通过实现mesh和model类。代码存储了模型的基本信息。Draw用于绘制mesh。

    vector<Vertex> vertices;
    vector<unsigned int> indices;
    vector<Texture> textures;
    unsigned int VAO;
    void Draw(Shader* shader) {
		shader->setVec3("light.ambient", glm::vec3(0));
		shader->setVec3("light.diffuse", glm::vec3(0));
		shader->setVec3("light.specular", glm::vec3(0));
		shader->setFloat("light.shininess", 32);
		shader->setInt("material.specular", 0);
		shader->setInt("material.diffuse", 0);
		shader->setInt("material.normal", 0);
		shader->setInt("material.height", 0);
		bool hasColor = false;
		bool hasTexture = false;
		for (unsigned int i = 0; i < textures.size(); i++) {
			string name = textures[i].type;
			if (name == "color") {
				hasColor = true;
				shader->setVec3("light.ambient", textures[i].ambientColor);
				shader->setVec3("light.diffuse", textures[i].diffuseColor);
				shader->setVec3("light.specular", textures[i].specularColor);
				if (textures[i].shininess != 0) {
					shader->setFloat("light.shininess", textures[i].shininess);
				}
			}
			else {
				hasTexture = true;
				glActiveTexture(GL_TEXTURE0 + i);
				shader->setInt(name.c_str(), i);
				glBindTexture(GL_TEXTURE_2D, textures[i].id);
			}
		}
		shader->setInt("hasColor", hasColor);
		shader->setInt("hasTexture", hasTexture);

		glBindVertexArray(VAO);
		glDrawElements(GL_TRIANGLES, indices.size(), GL_UNSIGNED_INT, 0);
		glBindVertexArray(0);

		glActiveTexture(GL_TEXTURE0);
	}
Model类包含了一个Mesh对象的vector，Draw函数就是遍历了所有网格，并调用mesh各自的Draw函数。processMesh函数用于访问网格的相关属性，并将它们储存到我们对象中。

## **实验感想**
相机与光照学习网上的教程，按照教程实现起来并不是很难，也就不做特别说明了，至于模型导入主要是寻找模型资源借助blender和3dsmax等软件进行模型的修改，包括自主设计一些模型，大多数素材还是来源于互联网，项目拖得比较久，常常会停滞不前，小组合作能力需要进一步提升。
